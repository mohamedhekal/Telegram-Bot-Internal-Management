# ุฏููู ุชูุงูู API - RKS Order Bot ๐

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ููุฒุฉ ุชูุงูู API ุฅูู ุงูุจูุช ูุฅุฑุณุงู ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ ุชููุงุฆูุงู ุฅูู ุงููุธุงู ุงูุฎุงุฑุฌู ุนุจุฑ API.

## ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ โจ

### 1. ุฅุฑุณุงู ุชููุงุฆู ููุทูุจุงุช
- ูู ุทูุจ ุฌุฏูุฏ ูุชู ุฅุถุงูุชู ุนุจุฑ ุงูุจูุช ุณูุชู ุฅุฑุณุงูู ุชููุงุฆูุงู ุฅูู API
- ูุชู ุชุณุฌูู ุญุงูุฉ ุงูุฅุฑุณุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ
- ุนุฑุถ ุญุงูุฉ API ูู ุฑุณุงูุฉ ุงูุชุฃููุฏ

### 2. ูุฑุงูุจุฉ ุญุงูุฉ API
- ุฎูุงุฑ ุฌุฏูุฏ "๐ ุญุงูุฉ API" ูู ูุงุฆูุฉ ุงููุฏูุฑ
- ุนุฑุถ ุงูุทูุจุงุช ุงููุงุดูุฉ ูู ุงูุฅุฑุณุงู
- ุฅููุงููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ููุทูุจุงุช ุงููุงุดูุฉ
- ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจู API

### 3. ุชุชุจุน ุงูุทูุจุงุช
- ุฌุฏูู ุฌุฏูุฏ `api_orders` ูุชุชุจุน ุงูุทูุจุงุช ุงููุฑุณูุฉ
- ุชุณุฌูู ูุนุฑู ุงูุทูุจ ูู API
- ุชุชุจุน ุนุฏุฏ ุงููุญุงููุงุช ููุทูุจุงุช ุงููุงุดูุฉ

## ุงูุฅุนุฏุงุฏ ูุงูุชูููู โ๏ธ

### 1. ุฅุนุฏุงุฏุงุช API ูู config.py

```python
# API Settings
API_ENABLED = True  # ุชูุนูู/ุฅูุบุงุก ุชูุนูู ุฅุฑุณุงู ุงูุทูุจุงุช ุฅูู API
API_BASE_URL = "https://rocklis.com/api/v1/admin/order/create"
API_USERNAME = "admin"  # ุงุณู ุงููุณุชุฎุฏู ููู API
API_PASSWORD = "admin123"  # ูููุฉ ุงููุฑูุฑ ููู API
API_TIMEOUT = 30  # ูููุฉ ุงูุงุชุตุงู ุจุงูุซูุงูู
```

### 2. ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

```bash
python test_api_connection.py
```

## ููููุฉ ุงูุงุณุชุฎุฏุงู ๐ฑ

### ููููุธููู ุงูุนุงุฏููู:
- ูุง ููุฌุฏ ุชุบููุฑ ูู ุงูุงุณุชุฎุฏุงู
- ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ ุณุชุชู ุฅุฑุณุงููุง ุชููุงุฆูุงู ุฅูู API
- ุณุชุธูุฑ ุญุงูุฉ API ูู ุฑุณุงูุฉ ุงูุชุฃููุฏ

### ูููุฏูุฑูู:
1. **ุนุฑุถ ุญุงูุฉ API**: ุงุฎุชุฑ "๐ ุญุงูุฉ API" ูู ุงููุงุฆูุฉ
2. **ูุฑุงูุจุฉ ุงูุทูุจุงุช ุงููุงุดูุฉ**: ุนุฑุถ ุงูุทูุจุงุช ุงูุชู ูุดูุช ูู ุงูุฅุฑุณุงู
3. **ุฅุนุงุฏุฉ ุงููุญุงููุฉ**: ุฒุฑ "๐ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ููุทูุจุงุช ุงููุงุดูุฉ"
4. **ุงุฎุชุจุงุฑ ุงูุงุชุตุงู**: ุนุฑุถ ุญุงูุฉ ุงูุงุชุตุงู ุจู API

## ุฑุณุงุฆู ุงูุชุฃููุฏ ุงูุฌุฏูุฏุฉ ๐

### ุนูุฏ ูุฌุงุญ ุงูุฅุฑุณุงู:
```
โ ุชู ุฅุถุงูุฉ ุงููุงุชูุฑุฉ ุจูุฌุงุญ!

๐ ุชูุงุตูู ุงููุงุชูุฑุฉ:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ข ุฑูู ุงูุฅูุตุงู: INV-20240115123456
๐ค ุงุณู ุงูููุธูุฉ: ููุฑ
๐ฅ ุฃุณู ุงูุนููู: ูุญูุฏ
๐๏ธ ุงููุญุงูุธุฉ: ุงูุงูุจุงุฑ
๐ ุฃูุฑุจ ููุทุฉ ุฏุงูุฉ: ุงูุฑูุงุฏู
๐ ุงูุฑูู: 0782444
๐ฆ ุงูุนุฏุฏ: 1
๐ฐ ุงูุณุนุฑ: 40,000 ุฏููุงุฑ
๐ ุงูููุงุญุธุงุช: ูุงุดูุฆ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โฐ ุงูุชุงุฑูุฎ: 2024-01-15 12:34

๐ ุญุงูุฉ API:
โ ุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู ุงููุธุงู ุงูุฎุงุฑุฌู ุจูุฌุงุญ
๐ ูุนุฑู ุงูุทูุจ: 12345
๐ ูุฌููุนุฉ ุงูุทูุจ: API-1703123456-1234
```

### ุนูุฏ ูุดู ุงูุฅุฑุณุงู:
```
๐ ุญุงูุฉ API:
โ ูุดู ูู ุฅุฑุณุงู ุงูุทูุจ ุฅูู ุงููุธุงู ุงูุฎุงุฑุฌู
โ๏ธ ุงูุณุจุจ: ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู
๐ก ุณูุชู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุชููุงุฆูุงู
```

## ูุฑุงูุจุฉ ุญุงูุฉ API ๐

### ุนุฑุถ ุงูุทูุจุงุช ุงููุงุดูุฉ:
```
๐ ุญุงูุฉ API - ุงูุทูุจุงุช ุงููุงุดูุฉ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ุนุฏุฏ ุงูุทูุจุงุช ุงููุงุดูุฉ: 3

๐ ุขุฎุฑ 5 ุทูุจุงุช ูุงุดูุฉ:

1. ุฑูู ุงูุฅูุตุงู: INV-20240115123456
   ๐ค ุงูููุธู: ููุฑ
   ๐ฅ ุงูุนููู: ูุญูุฏ
   ๐ฐ ุงููุจูุบ: 40,000 ุฏููุงุฑ
   โ๏ธ ุงูุณุจุจ: ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู
   ๐ ุงููุญุงููุงุช: 2
   ๐ ุงูุชุงุฑูุฎ: 2024-01-15 12:34:56
```

### ุญุงูุฉ ุงูุงุชุตุงู:
```
๐ ุญุงูุฉ ุงูุงุชุตุงู:
โ ุงูุงุชุตุงู ุจู API ูุนูู ุจุดูู ุตุญูุญ
๐ก ุฑูุฒ ุงูุญุงูุฉ: 201
```

## ุฅุนุงุฏุฉ ุงููุญุงููุฉ ููุทูุจุงุช ุงููุงุดูุฉ ๐

### ุฒุฑ ุฅุนุงุฏุฉ ุงููุญุงููุฉ:
- ูุธูุฑ ูู ุตูุญุฉ ุญุงูุฉ API ุนูุฏ ูุฌูุฏ ุทูุจุงุช ูุงุดูุฉ
- ูููู ุจุฅุนุงุฏุฉ ุฅุฑุณุงู ุฌููุน ุงูุทูุจุงุช ุงููุงุดูุฉ
- ูุนุฑุถ ุชูุฑูุฑ ุจุงููุชุงุฆุฌ

### ุชูุฑูุฑ ุฅุนุงุฏุฉ ุงููุญุงููุฉ:
```
๐ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ููุทูุจุงุช ุงููุงุดูุฉ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ุงููุชุงุฆุฌ:
โ ูุฌุญ: 2 ุทูุจ
โ ูุดู: 1 ุทูุจ
๐ ุฅุฌูุงูู: 3 ุทูุจ

๐ ุชู ุฅุนุงุฏุฉ ุฅุฑุณุงู ุจุนุถ ุงูุทูุจุงุช ุจูุฌุงุญ!
โ๏ธ 1 ุทูุจ ูุง ูุฒุงู ูุงุดูุงู
```

## ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ๐๏ธ

### ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ:

#### ุฌุฏูู `api_orders`:
```sql
CREATE TABLE api_orders (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    invoice_id INTEGER,
    receipt_number TEXT,
    api_order_id INTEGER,
    api_order_group_id TEXT,
    api_status TEXT,
    api_message TEXT,
    sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    retry_count INTEGER DEFAULT 0,
    last_retry TIMESTAMP,
    FOREIGN KEY (invoice_id) REFERENCES invoices (id)
);
```

### ุงูุฏูุงู ุงูุฌุฏูุฏุฉ ูู DatabaseManager:

- `record_api_order()`: ุชุณุฌูู ูุชูุฌุฉ ุฅุฑุณุงู ุงูุทูุจ
- `get_api_order_status()`: ุงูุญุตูู ุนูู ุญุงูุฉ ุงูุทูุจ
- `get_failed_api_orders()`: ุงูุญุตูู ุนูู ุงูุทูุจุงุช ุงููุงุดูุฉ
- `update_api_order_retry()`: ุชุญุฏูุซ ุนุฏุฏ ุงููุญุงููุงุช
- `get_invoice_by_receipt()`: ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุงุชูุฑุฉ

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง ๐ง

### ูุดุงูู ุดุงุฆุนุฉ:

1. **ุฎุทุฃ ูู ุงูุงุชุตุงู**:
   - ุชุญูู ูู ุตุญุฉ ุงูุฑุงุจุท ูู `API_BASE_URL`
   - ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
   - ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฌุฏุงุฑ ุงููุงุฑู

2. **ุฎุทุฃ ูู ุงููุตุงุฏูุฉ**:
   - ุชุญูู ูู ุตุญุฉ `API_USERNAME` ู `API_PASSWORD`
   - ุชุฃูุฏ ูู ุฃู ุงูุญุณุงุจ ููุนู ูู ุงููุธุงู ุงูุฎุงุฑุฌู

3. **ุฎุทุฃ ูู ุงูุจูุงูุงุช**:
   - ุชุญูู ูู ุชูุณูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ
   - ุชุฃูุฏ ูู ูุฌูุฏ ุฌููุน ุงูุญููู ุงููุทููุจุฉ

### ุงุฎุชุจุงุฑ ุงูุงุชุตุงู:
```bash
python test_api_connection.py
```

### ุฅูุบุงุก ุชูุนูู API ูุคูุชุงู:
```python
# ูู config.py
API_ENABLED = False
```

## ุงูุฃูุงู ๐

### ุฅุนุฏุงุฏุงุช ุงูุฃูุงู:
- ุงุณุชุฎุฏุงู HTTPS ููุงุชุตุงู
- ุชุฎุฒูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูู ููู config ูููุตู
- ุชุณุฌูู ุฌููุน ูุญุงููุงุช ุงูุงุชุตุงู
- ูููุฉ ุฒูููุฉ ููุงุชุตุงู ูููุน ุงูุชุนููู

### ุชูุตูุงุช:
- ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุจุงูุชุธุงู
- ูุฑุงูุจุฉ ุณุฌูุงุช ุงูุงุชุตุงู
- ุงุณุชุฎุฏุงู VPN ุฅุฐุง ูุฒู ุงูุฃูุฑ
- ูุณุฎ ุงุญุชูุงุทูุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช

## ุงูุชุทููุฑ ุงููุณุชูุจูู ๐

### ุงูููุฒุงุช ุงููุฎุทุท ููุง:
- ุฅุฑุณุงู ุชุญุฏูุซุงุช ุญุงูุฉ ุงูุทูุจ
- ูุฒุงููุฉ ุงูุจูุงูุงุช ุซูุงุฆูุฉ ุงูุงุชุฌุงู
- ุฅุดุนุงุฑุงุช ููุฑูุฉ ูุญุงูุฉ ุงูุทูุจ
- ูุงุฌูุฉ ุฅุฏุงุฑุฉ ูุชูุฏูุฉ ูู API
- ุฏุนู ูุชุนุฏุฏ ููุฃูุธูุฉ ุงูุฎุงุฑุฌูุฉ

### ุงูุชุญุณููุงุช:
- ุชุญุณูู ุฃุฏุงุก ุงูุงุชุตุงู
- ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุฎูุงุฑุงุช ุงูุชูููู
- ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ
- ุฅุถุงูุฉ ุฅุญุตุงุฆูุงุช ููุตูุฉ

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ ๐ฌ

### ูููุณุงุนุฏุฉ:
- ุฑุงุฌุน ูุฐุง ุงูุฏููู ุฃููุงู
- ุงุฎุชุจุฑ ุงูุงุชุตุงู ุจุงุณุชุฎุฏุงู `test_api_connection.py`
- ุชุญูู ูู ุณุฌูุงุช ุงูุจูุช ููุฃุฎุทุงุก
- ุฑุงุฌุน ุฅุนุฏุงุฏุงุช `config.py`

### ุงูุชูุงุตู:
- ูููุดุงูู ุงูุชูููุฉ: ุฑุงุฌุน ููู `TROUBLESHOOTING.md`
- ููุงูุชุฑุงุญุงุช: ุฃุฑุณู ุฑุณุงูุฉ ูููุทูุฑ
- ููุชุญุฏูุซุงุช: ุชุงุจุน ุงููุณุชูุฏุน ุจุงูุชุธุงู
