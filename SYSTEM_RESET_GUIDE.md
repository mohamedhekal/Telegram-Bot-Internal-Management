# دليل استخدام ميزات إعادة تعيين النظام 🔄

## نظرة عامة
تم إضافة ميزات إعادة تعيين النظام إلى البوت، مما يسمح للمديرين بحذف البيانات القديمة وتصفير الإحصائيات مع الاحتفاظ بالمستخدمين وبياناتهم.

## الميزات المتاحة ⚙️

### 1. 🗑️ حذف الفواتير القديمة
- **الوظيفة**: حذف جميع الفواتير والإحصائيات مع الاحتفاظ بالمستخدمين
- **ما يتم حذفه**:
  - جميع الفواتير
  - جميع سجلات API
  - جميع المرتجعات
  - جميع الإحصائيات اليومية
  - جميع إحصائيات الشحن
- **ما يتم الاحتفاظ به**:
  - جميع المستخدمين
  - جميع كلمات المرور

### 2. 📊 تصفير الإحصائيات
- **الوظيفة**: تصفير الإحصائيات فقط مع الاحتفاظ بجميع البيانات الأخرى
- **ما يتم حذفه**:
  - الإحصائيات اليومية
  - إحصائيات الشحن
- **ما يتم الاحتفاظ به**:
  - جميع الفواتير
  - جميع المرتجعات
  - جميع سجلات API
  - جميع المستخدمين
  - جميع كلمات المرور

### 3. 🔄 إعادة تعيين النظام
- **الوظيفة**: حذف كل شيء ما عدا المستخدمين
- **ما يتم حذفه**:
  - جميع الفواتير
  - جميع سجلات API
  - جميع المرتجعات
  - جميع الإحصائيات اليومية
  - جميع إحصائيات الشحن
  - جميع كلمات المرور
- **ما يتم الاحتفاظ به**:
  - جميع المستخدمين فقط

## كيفية الاستخدام 🚀

### الوصول للميزات:
1. **افتح البوت** في تيليجرام
2. **اضغط على "⚙️ إعدادات النظام"**
3. **اختر الميزة المطلوبة** من القائمة

### 1. حذف الفواتير القديمة:
```
🗑️ حذف الفواتير القديمة
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 ما تم حذفه:
• الفواتير: 150 فاتورة
• سجلات API: 150 سجل
• المرتجعات: 5 مرتجع
• الإحصائيات اليومية: 30 سجل
• إحصائيات الشحن: 10 سجل

✅ تم الاحتفاظ بـ:
• المستخدمين: 5 مستخدم
• كلمات المرور: 3 كلمة مرور

📈 حالة النظام الحالية:
• الفواتير: 0 فاتورة
• المرتجعات: 0 مرتجع
• سجلات API: 0 سجل
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 2. تصفير الإحصائيات:
```
📊 تم تصفير الإحصائيات بنجاح!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📈 ما تم تصفيره:
• الإحصائيات اليومية: 30 سجل
• إحصائيات الشحن: 10 سجل

✅ تم الاحتفاظ بـ:
• جميع الفواتير
• جميع المرتجعات
• جميع سجلات API
• جميع المستخدمين
• جميع كلمات المرور
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 3. إعادة تعيين النظام:
```
🔄 تم إعادة تعيين النظام بنجاح!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🗑️ ما تم حذفه:
• الفواتير: 150 فاتورة
• سجلات API: 150 سجل
• المرتجعات: 5 مرتجع
• الإحصائيات اليومية: 30 سجل
• إحصائيات الشحن: 10 سجل
• كلمات المرور: 3 كلمة مرور

✅ تم الاحتفاظ بـ:
• المستخدمين: 5 مستخدم

📈 حالة النظام الحالية:
• الفواتير: 0 فاتورة
• المرتجعات: 0 مرتجع
• سجلات API: 0 سجل
• كلمات المرور: 0 كلمة مرور
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ تحذير: تم حذف جميع البيانات ما عدا المستخدمين!
```

## متى تستخدم كل ميزة؟ 🤔

### 🗑️ حذف الفواتير القديمة:
- **عندما تريد**: تنظيف قاعدة البيانات من الفواتير القديمة
- **مثال**: في نهاية الشهر أو السنة
- **الفوائد**: تحرير مساحة التخزين، تحسين الأداء
- **الاحتياطات**: تأكد من عمل نسخة احتياطية قبل الحذف

### 📊 تصفير الإحصائيات:
- **عندما تريد**: إعادة تعيين الإحصائيات مع الاحتفاظ بالبيانات
- **مثال**: بداية فترة إحصائية جديدة
- **الفوائد**: إعادة تعيين العدادات، تحسين الأداء
- **الاحتياطات**: البيانات الأصلية محفوظة

### 🔄 إعادة تعيين النظام:
- **عندما تريد**: بداية جديدة للنظام
- **مثال**: تغيير الفترة المحاسبية، إعادة هيكلة النظام
- **الفوائد**: نظام نظيف تماماً
- **الاحتياطات**: ⚠️ **تحذير**: سيتم حذف كل شيء ما عدا المستخدمين!

## إجراءات الأمان 🔒

### 1. التحقق من الصلاحيات
- فقط مديري المخزن يمكنهم الوصول لهذه الميزات
- التحقق من هوية المستخدم قبل تنفيذ العمليات

### 2. الاحتفاظ بالمستخدمين
- جميع العمليات تحتفظ بالمستخدمين
- لا يمكن حذف بيانات المستخدمين عن طريق الخطأ

### 3. رسائل التأكيد
- عرض تفصيلي لما سيتم حذفه
- عرض تفصيلي لما سيتم الاحتفاظ به
- تحذيرات واضحة للعمليات الخطيرة

### 4. معالجة الأخطاء
- رسائل خطأ واضحة ومفيدة
- إرجاع النظام لحالة آمنة في حالة الفشل

## نصائح للاستخدام الآمن 💡

### 1. قبل استخدام الميزات:
- **عمل نسخة احتياطية** من قاعدة البيانات
- **التأكد من عدم وجود عمليات جارية**
- **إخطار المستخدمين** بالتغييرات

### 2. اختيار الميزة المناسبة:
- **للتنظيف الدوري**: استخدم "حذف الفواتير القديمة"
- **لإعادة تعيين الإحصائيات**: استخدم "تصفير الإحصائيات"
- **لإعادة تعيين كامل**: استخدم "إعادة تعيين النظام"

### 3. بعد استخدام الميزات:
- **التحقق من حالة النظام**
- **اختبار الوظائف الأساسية**
- **إعادة إعداد الإعدادات المطلوبة**

## استكشاف الأخطاء 🔍

### إذا فشلت العملية:

1. **تحقق من الصلاحيات**
   - تأكد من أنك مدير مخزن
   - تأكد من صحة حسابك

2. **تحقق من قاعدة البيانات**
   - تأكد من اتصال قاعدة البيانات
   - تحقق من مساحة التخزين

3. **تحقق من السجلات**
   - راجع رسائل الخطأ
   - اتصل بالدعم التقني إذا لزم الأمر

### رسائل الخطأ الشائعة:

```
❌ فشل في حذف الفواتير القديمة!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ السبب: database is locked
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**الحل**: انتظر قليلاً وحاول مرة أخرى، أو أعد تشغيل البوت

## الدعم التقني 🛠️

إذا واجهت أي مشاكل:

1. **راجع هذا الدليل** أولاً
2. **اختبر الميزات** باستخدام ملف الاختبار
3. **تحقق من الأخطاء الشائعة**
4. **اتصل بالدعم التقني** مع تفاصيل المشكلة

## ملفات الاختبار 🧪

### `test_system_reset.py`
- اختبار الحصول على إحصائيات النظام
- اختبار تصفير الإحصائيات
- اختبار حذف الفواتير القديمة
- اختبار إعادة تعيين النظام
- اختبار إجراءات الأمان

### تشغيل الاختبار:
```bash
python3 test_system_reset.py
```

---

**تاريخ الإنشاء**: 15 يناير 2024  
**الإصدار**: 1.0  
**المطور**: RKS Team
