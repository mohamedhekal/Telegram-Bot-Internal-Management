# دليل استخدام قوالب الشحن الجديدة

## 📋 نظرة عامة

تم إنشاء قوالب إكسل جديدة لتحميل الطلبات بالشكل المطلوب لشركة التوصيل. القوالب تحتوي على جميع الأعمدة المطلوبة مع مفاتيح المحافظات العراقية.

## 📁 الملفات المتوفرة

### 1. قوالب فارغة للاستخدام
- `قالب_الشحن_فارغ_YYYYMMDD_HHMMSS.xlsx` - قالب فارغ بدون بيانات تجريبية
- `قالب_الشحن_YYYYMMDD_HHMMSS.xlsx` - قالب مع بيانات تجريبية للعرض

### 2. ملفات البيانات المحولة
- `طلبات_محولة_YYYYMMDD_HHMMSS.xlsx` - البيانات الموجودة محولة للشكل الجديد

## 🏗️ هيكل القالب

### الأعمدة المطلوبة:

| العمود | الوصف | إجباري | ملاحظات |
|--------|-------|--------|---------|
| ملاحظات | ملاحظات إضافية | لا | يمكن تركها فارغة |
| عدد القطع | عدد القطع المطلوبة | نعم | رقم صحيح |
| يحتوي على ارجاع بضاعة؟ | هل يحتوي على مرتجع | نعم | "نعم" أو "لا" |
| هاتف المستلم | رقم هاتف المستلم | نعم | 11 خانة رقم |
| تفاصيل العنوان | العنوان المفصل | نعم | عنوان كامل |
| شفرة المحافظة | رمز المحافظة | نعم | راجع جدول المحافظات |
| أسم المستلم | اسم المستلم الكامل | نعم | الاسم الكامل |
| المبلغ عراقي | المبلغ بالدينار العراقي | نعم | بالآلاف، 0 إذا غير متوفر |

## 🏛️ مفاتيح المحافظات

| المحافظة | الشفرة |
|----------|--------|
| بغداد | BGD |
| الناصرية ذي قار | NAS |
| ديالى | DYL |
| الكوت واسط | KOT |
| كربلاء | KRB |
| دهوك | DOH |
| بابل الحلة | BBL |
| النجف | NJF |
| البصرة | BAS |
| اربيل | ARB |
| كركوك | KRK |
| السليمانيه | SMH |
| صلاح الدين | SAH |
| الانبار رمادي | ANB |
| السماوة المثنى | SAM |
| موصل | MOS |
| الديوانية | DWN |
| العمارة ميسان | AMA |

## 📊 أوراق العمل في الملف

### 1. طلبات الشحن
الورقة الرئيسية التي تحتوي على بيانات الطلبات.

### 2. مفاتيح المحافظات
جدول مرجعي لجميع مفاتيح المحافظات العراقية.

### 3. تعليمات الاستخدام (في القوالب الفارغة)
دليل مفصل لكيفية استخدام القالب.

### 4. ملخص التحويل (في الملفات المحولة)
معلومات عن عملية تحويل البيانات.

## 🚀 كيفية الاستخدام

### للاستخدام الجديد:
1. استخدم `قالب_الشحن_فارغ_YYYYMMDD_HHMMSS.xlsx`
2. املأ البيانات في ورقة "طلبات الشحن"
3. استخدم ورقة "مفاتيح المحافظات" للتحقق من الشفرات
4. احفظ الملف واستخدمه للشحن

### للبيانات الموجودة:
1. استخدم `طلبات_محولة_YYYYMMDD_HHMMSS.xlsx`
2. راجع البيانات المحولة وتأكد من صحتها
3. عدل أي بيانات إذا لزم الأمر
4. استخدم الملف للشحن

## ⚠️ ملاحظات مهمة

### قواعد البيانات:
- **عدد القطع**: يجب أن يكون رقماً صحيحاً
- **هاتف المستلم**: يجب أن يكون 11 خانة رقم
- **شفرة المحافظة**: يجب أن تكون من القائمة المحددة
- **المبلغ عراقي**: بالآلاف، 0 إذا غير متوفر

### التنسيق:
- جميع الأعمدة محاذاة للوسط
- العناوين بلون أزرق مع خط أبيض
- حدود للخلايا لسهولة القراءة
- عرض أعمدة محسن للقراءة

## 🔧 السكريبتات المتوفرة

### 1. `create_shipping_template.py`
- إنشاء قوالب فارغة جديدة
- إنشاء قوالب مع بيانات تجريبية

### 2. `convert_existing_data.py`
- تحويل البيانات الموجودة في قاعدة البيانات
- عرض إحصائيات قاعدة البيانات
- إنشاء ملفات محولة جاهزة للاستخدام

## 📈 إحصائيات قاعدة البيانات الحالية

بناءً على آخر تشغيل:
- إجمالي الفواتير: 12
- فواتير الأسبوع: 12
- فواتير الشهر: 12

### توزيع المحافظات:
- الانبار (ANB): 8 طلب
- بغداد (BGD): 2 طلب
- البصرة (BAS): 1 طلب
- الناصرية (NAS): 1 طلب

## 🎯 الخطوات التالية

1. **راجع الملفات المنشأة** وتأكد من صحة البيانات
2. **اختبر القوالب** مع شركة التوصيل
3. **عدل البيانات** إذا لزم الأمر
4. **استخدم القوالب** لتحميل الطلبات الجديدة

## 📞 الدعم

إذا واجهت أي مشاكل أو تحتاج مساعدة إضافية:
1. راجع التعليمات في ورقة "تعليمات الاستخدام"
2. تأكد من صحة مفاتيح المحافظات
3. تحقق من تنسيق البيانات المدخلة
